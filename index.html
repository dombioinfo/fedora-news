<!DOCTYPE HTML>
<html>
<head>
    <title>Fedora news apps</title>
    <link rel="shortcut icon" type="image/vnd.microsoft.icon"
      href="//fedoraproject.org/static/images/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <link rel="apple-touch-icon" href="img/Fedora.png"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/git/jquery.mobile-git.css" type="text/css"> 
    <link rel="stylesheet" href="css/main.css" type="text/css"/>
    <script src="http://code.jquery.com/jquery-1.9.1.js"
        type="text/javascript"></script> 
    <script src="http://code.jquery.com/mobile/git/jquery.mobile-git.js"
        type="text/javascript"></script>
    <script src="js/fedora_apps.js" type="text/javascript"></script>
    <script type="text/javascript">
      $(function () {
        /* Refresh buttons */
        $('#refresh_planet').bind("click", function () {
          update_planet();
        });
        $('#refresh_updates').bind("click", function () {
          console.log('refresh updates');
        });
        $('#refresh_builds').bind("click", function () {
          console.log('refresh builds');
        });
        $('#refresh_meetings').bind("click", function () {
          console.log('refresh meetings');
        });
        $('#refresh_all').bind("click", function () {
          update_planet(false);
          $("#message_home").text('Cache refreshed');
        });
        

        /* Clear buttons */
        $('#clear_planet').bind("click", function () {
          $("#content_planet").html('');
          localStorage.planet_entries = null;
          $("#message_planet").text('Cache cleared');
        });
        $('#clear_updates').bind("click", function () {
          $("#content_updates").html('');
          localStorage.updates_entries = null;
          $("#message_updates").text('Cache cleared');
        });
        $('#clear_builds').bind("click", function () {
          $("#content_build").html('');
          localStorage.builds_entries = null;
          $("#message_builds").text('Cache cleared');
        });
        $('#clear_meetings').bind("click", function () {
          $("#content_meetings").html('');
          localStorage.meeting_entries = null;
          $("#message_meetings").text('Cache cleared');
        });

        if (navigator.mozApps) {
          var request = navigator.mozApps.getSelf();
          request.onsuccess = function() {
            if (!this.result) {
              console.log(location.protocol + "//" + location.host + location.pathname + "manifest.webapp");
              request = navigator.mozApps.install(location.protocol + "//" + location.host + location.pathname + "manifest.webapp");
              request.onerror = function() {
                console.log("Install failed: " + this.error.name);
              };
            }
          };
        }
      });

      /* Load content of page change */
      $(document).on("pagechange", function () {
        $("#message_home").text('');
        var page_id = $.mobile.activePage.attr("id");
        if (page_id == 'planet_page') {
          load_planet();
        } else if (page_id == 'updates_page') {
          console.log('load updates');
        } else if (page_id == 'builds_page') {
          console.log('load builds');
        } else if (page_id == 'meetings_page') {
          console.log('load meetings');
        }
      });
    </script>

</head>
<body>
    <section id="index_page" data-role="page">
      <div data-role="header">
        <h1>Fedora News</h1>
      </div><!-- /header -->
      <div data-role="content">
        <p id="message_home"></p>
      <table>
        <tr>
          <td>
            <a id="home_planet" href="#planet_page">
              <img src="img/planet.png" alt="Fedora Planet" />
            </a>
          </td>
          <td>
            <a id="home_updates" href="#updates_page">
              <img src="img/updates.png" alt="Latest updates" />
            </a>
          </td>
        </tr>
        <tr>
          <td>
            <a id="home_builds" href="#builds_page">
              <img src="img/builds.png" alt="Latest builds" />
            </a>
          </td>
          <td>
            <a id="home_meetings" href="#meetings_page">
              <img src="img/meetings.png" alt="Coming meetings" />
            </a>
          </td>
        </tr>
      </table>
      <a data-role="button" data-theme="c" data-icon="refresh" href='#' id='refresh_all'>Refresh all</a>
    </div>
    </section>

    <section id="planet_page" data-role="page">
      <div data-role="header">
        <a data-role="button" data-theme="c" data-icon="arrow-l" class="home_button" href='#index_page'>Back</a>
        <a data-role="button" data-theme="c" data-icon="refresh" class="home_button" id='refresh_planet'>Refresh</a>
        <h1>Fedora Planet</h1>
      </div><!-- /header -->
      <div data-role="content">
        <p id="message_planet">Check out the last 10 blog posts of the planet</p>
        <div data-role="collapsible-set" data-theme="c" data-content-theme="d" id="content_planet">
        </div>
        <a data-role="button" data-theme="c" data-icon="delete" class="home_button" href='#' id='clear_planet'>clear</a>
      </div>
    </section>

    <section id="updates_page" data-role="page">
      <div data-role="header">
        <a data-role="button" data-theme="c" data-icon="arrow-l" class="home_button" href='#index_page'>Back</a>
        <a data-role="button" data-theme="c" data-icon="refresh" class="home_button" href='#' id='refresh_updates'>Refresh</a>
        <h1>Latest updates</h1>
      </div><!-- /header -->

      <div data-role="content">
        <p id="message_updates">Check out the 10 latest updates</p>
        <div data-role="collapsible-set" data-theme="c" data-content-theme="d" id="content_updates">
        </div>
        <a data-role="button" data-theme="c" data-icon="delete" class="home_button" href='#' id='clear_updates'>clear</a>
      </div><!-- /content -->
    </section>

    <section id="builds_page" data-role="page">
      <div data-role="header">
        <a data-role="button" data-theme="c" data-icon="arrow-l" class="home_button" href='#index_page'>Back</a>
        <a data-role="button" data-theme="c" data-icon="refresh" class="home_button" href='#' id='refresh_builds'>Refresh</a>
        <h1>Latest builds</h1>
      </div><!-- /header -->

      <div data-role="content">
        <p id="message_builds">Check out the 10 latest builds</p>
        <div data-role="collapsible-set" data-theme="c" data-content-theme="d" id="content_builds">
        </div>
        <a data-role="button" data-theme="c" data-icon="delete" class="home_button" href='#' id='clear_builds'>clear</a>
      </div><!-- /content -->
    </section>

    <section id="meetings_page" data-role="page">
      <div data-role="header">
          <a data-role="button" data-theme="c" data-icon="arrow-l" class="home_button" href='#index_page'>Back</a>
        <a data-role="button" data-theme="c" data-icon="refresh" class="home_button" href='#' id='refresh_meetings'>Refresh</a>
          <h1>Coming meetings</h1>
      </div><!-- /header -->

      <div data-role="content">
        <p id="message_meetings">Check out the 10 coming meetings</p>
        <div data-role="collapsible-set" data-theme="c" data-content-theme="d" id="content_meetings">
        </div>
        <a data-role="button" data-theme="c" data-icon="delete" class="home_button" href='#' id='clear_meetings'>clear</a>
      </div><!-- /content -->
 
    </section>

</body>
</html> 
